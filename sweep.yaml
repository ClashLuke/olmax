program: main.py
method: bayes
metric:
  name: Loss/Median1024
  goal: minimize
command:
  - bash
  - run.sh
  - python3
  - ${args}
parameters: # See https://wandb.ai/homebrewnlp/gpt/sweeps/xuwcs6i1 for initial sweep space
  optimizer.learning_rate:
    distribution: log_uniform_values
    min: 0.001
    max: 0.1
  optimizer.adam_beta2:
    distribution: log_uniform_values
    min: 0.005
    max: 0.02
  optimizer.adam_beta1:
    distribution: log_uniform_values
    min: 0.05
    max: 0.2
  optimizer.momentum_beta:
    distribution: log_uniform_values
    min: 0.05
    max: 0.2

  # New parameters
  optimizer.gradient_clip:
    distribution: log_uniform_values
    min: 0.001
    max: 0.1
  optimizer.weight_decay:
    distribution: log_uniform_values
    min: 0.001
    max: 0.1
  training.z_loss:
    distribution: log_uniform_values
    min: 0.0001
    max: 0.1