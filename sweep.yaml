program: main.py
method: bayes
metric:
  name: Loss/Median1024
  goal: minimize
command:
  - bash
  - run.sh
  - python3
  - ${args}
parameters:
  optimizer.learning_rate:
    distribution: log_uniform_values
    min: 0.001  # See https://wandb.ai/homebrewnlp/gpt/sweeps/1xiemhjd for initial sweep space
    max: 0.1
  optimizer.adam_beta2:
    distribution: log_uniform_values
    min: 0.00001
    max: 1
  optimizer.adam_beta1:
    distribution: log_uniform_values
    min: 0.001
    max: 1
  optimizer.momentum_beta:
    distribution: log_uniform_values
    min: 0.01
    max: 1

  dims.sizes.depthwise_conv_kernel:
    distribution: q_log_uniform_values
    min: 2
    max: 128